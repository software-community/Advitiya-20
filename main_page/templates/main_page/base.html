{% load static %}
{% load socialaccount %}
<!DOCTYPE html>

<head>
    {% block style %}{%endblock%}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="{% static 'ca/img/favicon.jpg' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
        integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/owl-carousel/1.3.3/owl.carousel.min.css">
    <link rel="stylesheet" href="https://unpkg.com/flickity@2.0/dist/flickity.min.css">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/material-design-iconic-font/2.2.0/css/material-design-iconic-font.min.css">
    <link href="{% static 'main_page/css/style.css' %}" rel="stylesheet">
    <title>{% block title %} Advitiya{%endblock%} </title>
    <style>
        @media only screen and (min-width: 980px) {
            .resizeflex {
                display: flex;
            }
        }
    </style>
</head>

<body>
    <div id="preloader">
        <div class="loader"></div>
    </div>
    <header class="header-area" style="background-color: black;">
        <div class="classy-nav-container breakpoint-off">
            <div class="container" style="padding-left: 0px; padding-right: 0px;">
                <!-- Classy Menu -->
                <nav class="classy-navbar justify-content-between" id="conferNav">
                    <!-- Logo -->
                    <a class="navbar-brand" href="{% url 'main_page:index' %}">
                        <img src="{% static 'ca/img/logo.png' %}" width="200" alt="">
                    </a>
                    <!-- Navbar Toggler -->
                    <div class="classy-navbar-toggler">
                        <span class="navbarToggler"><span></span><span></span><span></span></span>
                    </div>

                    <!-- Menu -->
                    <div class="classy-menu">
                        <!-- Menu Close Button -->
                        <div class="classycloseIcon">
                            <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                        </div>

                        <!-- Nav Start -->
                        <div class="classynav">
                            <ul id="nav" class="resizeflex">
                                <li><a href="{% url 'main_page:events'%}">Events</a></li>
                                <!-- <li><a href="{% url 'accomodation:index'%}">Talks</a></li> -->
                                <li><a href="{% url 'techconnect:index'%}">TechConnect</a></li>
                                <li><a href="{% url 'main_page:workshop'%}">Workshops</a></li>
                                <li><a href="{% url 'main_page:sponsors'%}">Sponsors</a></li>
                                <li><a href="#"><i class="zmdi zmdi-caret-down-circle"></i> Accommodation</a>
                                    <ul class="dropdown" style="width: 200%;">
                                        <li><a href="{% url 'main_page:get_workshop_accommodation' %}">Workshop
                                                Participants</a></li>
                                        <li><a href="{% url 'accomodation:index' %}">Non-Workshop Participants</a></li>
                                    </ul>
                                </li>
                                <li><a href="#"><i class="zmdi zmdi-caret-down-circle"></i> More</a>
                                    <ul class="dropdown" style="width: 300%;">
                                        <li><a href="{% url 'TSP:home' %}">Techno School Program(TSP)</a></li>

                                        <li><a href="{% url 'ca:home' %}">Campus Ambassador</a></li>
                                    </ul>
                                </li>

                                {% if user.is_authenticated %}
                                <li>
                                    <a href="#"><i class="zmdi zmdi-account-circle zmdi-hc-3x"></i></a>
                                    <ul class="dropdown">
                                        <li><a href="{% url 'main_page:profile' %}">Profile</a></li>
                                        <li><a
                                                href="{% url 'main_page:account_logout' %}?next={{ request.path}}">Logout</a>
                                        </li>
                                    </ul>
                                </li>
                                {% else %}
                                <li>
                                    <a href="{% provider_login_url 'google' %}?next={{ request.path}}"
                                        class="btn btn-secondary" style="margin-bottom: 3px;">
                                        <i class="fab fa-google"></i> Sign In
                                    </a>
                                </li>
                                {% endif %}
                            </ul>
                        </div>
                    </div>
                    <!-- Nav End -->
                </nav>
            </div>
        </div>
    </header>

    {% block body %}


    {% endblock %}

    {% block footer%}
    <!-- Footer Area Start -->
    <footer class="footer-area bg-img bg-overlay-2 section-padding-100-0">
        <!-- Main Footer Area -->
        <div class="main-footer-area">
            <div class="container">
                <div class="row">
                    <!-- Single Footer Widget Area -->
                    <div class="col-12 col-sm-6 col-lg-4">
                        <div class="single-footer-widget mb-60 wow fadeInUp" data-wow-delay="300ms">
                            <!-- Footer Logo -->
                            <a href="#" class="footer-logo"><img src="{% static 'ca/img/logo.png' %}" alt=""></a>
                            <p style="margin: 2px;">An initiative by IIT Ropar to promote Science & Technology.</p>
                            <br>
                            <!-- Social Info -->
                            <div class="social-info">
                                <a href="https://www.facebook.com/advitiya.iitrpr/"><i
                                        class="zmdi zmdi-facebook"></i></a>
                                <a href="https://www.instagram.com/advitiya_iitrpr/?hl=en"><i
                                        class="zmdi zmdi-instagram"></i></a>
                                <a href="https://twitter.com/advitiyaiitrpr?lang=en"><i
                                        class="zmdi zmdi-twitter"></i></a>

                            </div>
                        </div>
                    </div>

                    <!-- Single Footer Widget Area -->
                    <div class="col-12 col-sm-6 col-lg-4">
                        <div class="single-footer-widget mb-60 wow fadeInUp" data-wow-delay="300ms">
                            <!-- Widget Title -->
                            <h5 class="widget-title">Location</h5>
                            <p>Indian Institute of Technology Ropar, Bara Phool, Birla Seed Farms, Rupnagar,Punjab,
                                INDIA 140001
                            </p>
                            <p><i class="fa fa-phone mr-3"></i>+91 9915405007</p>
                            <p><i class="fa fa-phone mr-3"></i>+91 8619174962</p>
                            <p><i class="fa fa-envelope-o mr-3"></i>advitiya@iitrpr.ac.in</p>
                        </div>
                    </div>

                    <!-- Single Footer Widget Area -->
                    <div class="col-12 col-sm-6 col-lg-4">
                        <div class="single-footer-widget mb-60 wow fadeInUp" data-wow-delay="300ms">
                            <!-- Widget Title -->
                            <h5 class="widget-title"><a style="color: white;">Workshops</a></h5>
                            <ul class="footer-nav">
                                <li><a href="{% url 'techconnect:index'%}">TechConnect</a></li>
                                <li><a href="{% url 'main_page:workshop'%}">Workshops at IIT Ropar</a></li>
                            </ul>
                            <br>
                            <h5 class="widget-title"><a href="#" style="color: white;">Talks</a></h5>
                            <!-- Footer Nav -->
                            <ul class="footer-nav">
                                <li><a href="{% url 'main_page:talks' %}">Click here</a></li>
                            </ul>
                        </div>
                    </div>

                    <!-- Single Footer Widget Area -->

                </div>
            </div>
        </div>

        <!-- Copywrite Area -->
        <div class="container">
            <div class="copywrite-content">
                <div class="row">
                    <!-- Copywrite Text -->
                    <div class="copywrite-text">
                        <p>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                            Copyright &copy;
                            <script>document.write(new Date().getFullYear());</script> All rights reserved | This
                            template is made with <i class="fa fa-heart-o" aria-hidden="true"></i> by <a
                                href="https://colorlib.com" target="_blank">Colorlib</a>
                            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    {%endblock%}

    {% block scripts %}{%endblock%}
    <!-- Bootstrap core JavaScript and other JavaScript Files
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://kit.fontawesome.com/a9af552946.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
        integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
        integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"
        integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
        crossorigin="anonymous"></script>
    <script src="{% static 'main_page/js/confer.bundle.js' %}"></script>
    <script src="https://unpkg.com/flickity@2.0/dist/flickity.pkgd.min.js"></script>
    <script src="{% static 'main_page/js/active.js' %}"></script>
    <!-- <script src="{% static 'main_page/js/jquery.min.js' %}"></script> -->

    <!-- Firebase App (the core Firebase SDK) is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
    <!-- If you enabled Analytics in your project, add the Firebase SDK for Analytics -->
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-analytics.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-messaging.js"></script>
    <!-- START INITIALIZATION CODE -->
    <script>
        // Initialize Firebase
        var firebaseConfig = {
            apiKey: "AIzaSyDbNJ--j-m1WNrMxSHys81rjseH4FMuHys",
            authDomain: "advitiya2020-719da.firebaseapp.com",
            databaseURL: "https://advitiya2020-719da.firebaseio.com",
            projectId: "advitiya2020-719da",
            storageBucket: "advitiya2020-719da.appspot.com",
            messagingSenderId: "598295117177",
            appId: "1:598295117177:web:946a6512b805df9b0203a8",
            measurementId: "G-WRN5HSTQL9"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        firebase.analytics();
    </script>
    <!-- END INITIALIZATION CODE -->
    <!-- ******************************************************** -->
    <script>
        // [START get_messaging_object]
        // Retrieve Firebase Messaging object.
        const messaging = firebase.messaging();
        // [END get_messaging_object]

        // [START refresh_token]
        // Callback fired if Instance ID token is updated.
        messaging.onTokenRefresh(function () {
            messaging.getToken()
                .then(function (refreshedToken) {
                    console.log('Token refreshed.');
                    // Indicate that the new Instance ID token has not yet been sent to the
                    // Send Instance ID token to app server.
                    sendTokenToServer(refreshedToken);
                })
                .catch(function (err) {
                    console.log('Unable to retrieve refreshed token ', err);
                });
        });
        requestPermission();
        // [END refresh_token]
        messaging.onMessage(function (payload) {
            console.log("Message received. ", payload);
        });
        // [END receive_message]


        // Send the Instance ID token your application server, so that it can:
        // - send messages back to this app
        // - subscribe/unsubscribe the token from topics
        function sendTokenToServer(currentToken) {
            if (!isTokenSentToServer()) {
                console.log('Sending token to server...');
                // TODO(developer): Send the current token to your server.
                fetch('/devices/', {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        'registration_id': currentToken,
                        'type': 'web',
                    }),
                    credentials: "include",
                }).then(function (response) {
                    console.log(response);
                })
                setTokenSentToServer(true);
            } else {
                console.log('Token already sent to server so won\'t send it again ' +
                    'unless it changes');
            }

        }

        function isTokenSentToServer() {
            if (window.localStorage.getItem('sentToServer') == 1) {
                return true;
            }
            return false;
        }

        function setTokenSentToServer(sent) {
            if (sent) {
                window.localStorage.setItem('sentToServer', 1);
            } else {
                window.localStorage.setItem('sentToServer', 0);
            }
        }


        function requestPermission() {
            console.log('Requesting permission...');
            // [START request_permission]
            messaging.requestPermission()
                .then(function () {
                    console.log('Notification permission granted.');
                })
                .catch(function (err) {
                    console.log('Unable to get permission to notify.', err);
                });
            // [END request_permission]
        }


    </script>
</body>

</html>